import{_ as N,a as Z}from"./BallThrowing.dc9dba3c.js";import{r,w as x,a as M,b as V,e as O,o as m,f as p,h as ee,i as W,u as e,j as E,v as S,k as i,l as L,m as I,p as C,q,s as te,t as z,x as ae,y as j,z as ne,A as K,B as oe,C as se,D as le,F as re,E as ie,c as F,T as ce,G as ue,H as de,I as me,J as ve}from"./entry.6360bfc7.js";import"./_plugin-vue_export-helper.c27b6911.js";const G={__name:"SlideToggle",props:{stay:{type:Number,default:2e3},modelValue:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(w,{emit:f}){const c=w,s=r(null),a=r(c.modelValue?0:2);x(()=>c.modelValue,t=>{t&&(a.value=0)});const v=M(()=>a.value===0?"animate__fadeInRight":a.value===1?"animate__fadeOutRight":"translate-x-full"),o=()=>{a.value===0?setTimeout(()=>{a.value++},c.stay):(a.value++,f("update:modelValue",!1))},_=()=>{s.value.removeEventListener("webkitAnimationEnd",o),s.value.removeEventListener("animationend",o),s.value.removeEventListener("oanimationend",o)};return V(()=>{s.value.addEventListener("webkitAnimationEnd",o),s.value.addEventListener("animationend",o),s.value.addEventListener("oanimationend",o)}),O(()=>{_()}),(t,u)=>(m(),p("div",{ref_key:"elRef",ref:s,class:W(["animate__animated",e(v)])},[ee(t.$slots,"default")],2))}},_e=""+new URL("change-chance.38de7a4b.png",import.meta.url).href,fe={class:"flex justify-center items-center bg-white"},he={class:"w-1/5 mx-4"},pe={key:0,class:"relative"},ge={class:"w-1/5 mx-4"},be={class:"relative"},we={class:"absolute top-0 right-0 flex items-center justify-end w-full h-full"},Ce=i("img",{class:"w-80",src:_e,alt:""},null,-1),ye={__name:"ChangeChance",props:{card:{type:Object,required:!0}},emits:["takeCard"],setup(w,{emit:f}){const c=w,{lockCard:s}=z(),a=r(!0),v=r(null),o=()=>{f("takeCard",{origin:c.card,target:c.card})},_=()=>{window.removeEventListener("beforeunload",o)};return V(()=>{const t=()=>{const u=s(1,te)[0];u.cardId===c.card.cardId?t():v.value=u};t(),window.addEventListener("beforeunload",o)}),O(_),(t,u)=>{const g=N,n=G;return m(),p("div",fe,[E(i("div",he,[e(v)?(m(),p("div",pe,[L(g,{card:e(v)},{default:I(()=>[i("button",{class:"relative px-4 py-2 bg-slate-400",onClick:u[0]||(u[0]=b=>t.$emit("takeCard",{origin:w.card,target:e(v)}))},"取得")]),_:1},8,["card"])])):C("",!0)],512),[[S,!e(a)]]),E(i("div",ge,[i("div",be,[L(g,{card:w.card},{default:I(()=>[i("button",{class:"relative px-4 py-2 bg-slate-400",onClick:u[1]||(u[1]=b=>t.$emit("takeCard",{origin:w.card,target:w.card}))},"取得")]),_:1},8,["card"])])],512),[[S,!e(a)]]),E(i("div",we,[L(n,{modelValue:e(a),"onUpdate:modelValue":u[2]||(u[2]=b=>q(a)?a.value=b:null)},{default:I(()=>[Ce]),_:1},8,["modelValue"])],512),[[S,e(a)]])])}}},ke=""+new URL("fortune_wheel.3cd7285e.png",import.meta.url).href,$e=""+new URL("senior_wheel.5bb4acdf.png",import.meta.url).href,xe=""+new URL("senior.cfd57353.png",import.meta.url).href,De={class:"relative pb-[100%]"},Re=["src"],Le={class:"fixed top-0 right-0 flex items-center justify-end w-full h-full"},Ie=i("img",{class:"w-80",src:xe,alt:""},null,-1),Te={__name:"FortuneWheel",emits:["animationDone"],setup(w,{emit:f}){const c=r(Math.random()<ae),s=r(!1),a=r(!1);x(a,g=>{g||(s.value=!0,setTimeout(()=>{o.value=!0},1e3))});const v=M(()=>new URL(Object.assign({"../assets/images/fortune_wheel.png":ke,"../assets/images/senior_wheel.png":$e})[`../assets/images/${s.value?"senior":"fortune"}_wheel.png`],self.location).href),o=r(!c.value),_=r(0);x(o,g=>{if(g)window.requestAnimationFrame(t);else{const n=Object.values(j),b=n.reduce((h,R)=>h+R.weights,0),D=c.value?0:Math.random()*b;let B=0;for(let h=0;h<n.length;h++)if(B+=n[h].weights,D<=B){console.log(`%c投出: ${Object.keys(j)[h]} %c配率: ${c.value?"(前輩)100":(n[h].weights/b*100).toFixed(2)}%`,"color: black;","color: orange;"),f("animationDone",{bonus:n[h].bonus,color:n[h].color}),ne(()=>{_.value=n[h].degree});break}}});const t=()=>{o.value&&(_.value=_.value>=330?0:_.value+30,window.requestAnimationFrame(t))},u=()=>{o.value&&(o.value=!1)};return V(()=>{c.value&&(a.value=!0),window.requestAnimationFrame(t)}),(g,n)=>{const b=G;return m(),p("div",De,[i("img",{class:"block absolute left-0 top-0 w-full",style:K({transform:`rotate(${e(_)}deg)`}),src:e(v),alt:"",onClick:u},null,12,Re),E(i("div",Le,[L(b,{modelValue:e(a),"onUpdate:modelValue":n[0]||(n[0]=D=>q(a)?a.value=D:null)},{default:I(()=>[Ie]),_:1},8,["modelValue"])],512),[[S,e(a)]])])}}},Ae=""+new URL("arrow_l.c01e8aed.png",import.meta.url).href,Ee=""+new URL("arrow_r.c985b9bc.png",import.meta.url).href,Se=["src"],Ve={__name:"Keyboard",setup(w){const f=r(!0);return x(()=>f.value,c=>{setTimeout(()=>{f.value=!c},200)}),V(()=>{f.value=!f.value}),(c,s)=>(m(),p("img",{src:e(f)?e(Ae):e(Ee),alt:""},null,8,Se))}},Be={class:"relative"},Ue={class:"relative flex justify-center items-center h-[60vh]"},Fe={class:"relative"},Me=["onClick"],Pe=i("span",null,"取得",-1),je={key:0,class:"absolute right-0 -top-2 bg-red-500 text-white text-sm rounded whitespace-nowrap px-2 py-1 translate-x-2/3 rotate-[20deg]"},Ne={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},Oe={class:"h-[40vh] overflow-hidden"},We={class:"w-1/2 mx-auto"},qe={key:1,class:"absolute left-1/2 bottom-1/4 w-9/12 h-4 -translate-x-1/2 border"},ze={class:"absolute w-full text-center top-1/2 left-0 -translate-y-1/2 bg-red-600"},Ke={class:"inline-block text-white text-2xl sm:text-6xl italic py-8 animate__animated animate__flipInX"},Xe={__name:"battle",setup(w){const{lockCard:f,removeCard:c}=z(),s=r("");x(s,l=>{l!==""&&setTimeout(()=>{s.value=""},2e3)});const a=r([]),v=r([]),o=r(0);x(o,()=>{u.value&&v.value.length===o.value&&(console.log("全拿了! 結束 || 沒抓到 結束"),h())});const _=r([]),t=r(null),u=r(!1),g=r(0),n=oe({addition:0,animationStart:!1,animationDone:!1,ballColor:""});x(t,l=>{l===100&&(document.removeEventListener("keyup",D),s.value="Done !",setTimeout(()=>{u.value=!0},1e3))});const b=()=>{a.value=f(2,ue),g.value++,s.value=`BATTLE ROUND ${g.value} !`,setTimeout(()=>{t.value=0,document.addEventListener("keyup",D)},2e3)},D=l=>{const{code:d}=l;(d==="ArrowLeft"||d==="ArrowRight")&&(t.value=Math.min(t.value+10,100))},B=({bonus:l,color:d})=>{n.addition=l,n.ballColor=d,n.animationStart=!0,a.value.forEach(y=>{const T=Math.random(),A=Math.min(ve[y.cardLevel]+l,1);console.log(`${y.cardName}(${y.cardLevel}} ${A*100}%`,`${T} (${T<A?"捕捉成功":"捕捉失敗"})`),T<A&&v.value.push({id:y.cardId,chance:Math.random()})})},h=()=>{u.value=!1,n.addition=0,n.animationStart=!1,n.animationDone=!1,o.value=0,U.value=0,v.value.length=0,_.value.length=0,g.value<2&&Math.random()<se?(console.log("連續對戰!"),b()):le("/")},R=r(null),H=({origin:l,target:d})=>{R.value=null,o.value++,_.value.push(l.cardId),c(d.cardId)},J=l=>{if(P(l.cardId)){R.value=l;return}else o.value++,_.value.push(l.cardId),c(l.cardId)},U=r(0),P=l=>{const d=v.value.find(y=>y.id===l);return d?d.chance<me:!1},X=M(()=>l=>n.animationDone?l?"capture-success":"capture-failed":"");return V(b),(l,d)=>{const y=N,T=Z,A=ye,Y=Te,Q=Ve;return m(),p("div",Be,[i("div",Ue,[(m(!0),p(re,null,ie(e(a),k=>(m(),p("div",{key:k.cardId,class:W(["w-1/5 mx-4 animate__animated animate__flipInY",[e(_).some($=>$===k.cardId)&&"invisible"]])},[i("div",Fe,[L(y,{class:"animate__animated",animation:e(X)(e(v).some($=>$.id===k.cardId)),card:k,onAnimationDone:d[0]||(d[0]=$=>U.value++)},{default:I(()=>[e(v).some($=>$.id===k.cardId)&&e(U)===2?(m(),p("button",{key:0,class:"relative px-4 py-2 bg-slate-400",onClick:$=>J(k)},[Pe,P(k.cardId)?(m(),p("span",je," 交換機會 ")):C("",!0)],8,Me)):C("",!0)]),_:2},1032,["animation","card"]),i("div",Ne,[e(n).animationStart?(m(),F(T,{key:0,color:e(n).ballColor,onAnimationDone:d[1]||(d[1]=$=>e(n).animationDone=!0)},null,8,["color"])):C("",!0)])])],2))),128)),e(U)===2?(m(),p("button",{key:0,class:"absolute bottom-2 left-1/2 -translate-x-1/2 px-4 py-2 bg-slate-400",onClick:h},"不取得")):C("",!0)]),e(R)?(m(),F(A,{key:0,class:"absolute w-full h-full top-0 left-0 z-10",card:e(R),onTakeCard:H},null,8,["card"])):C("",!0),i("div",Oe,[i("div",We,[e(u)?(m(),F(Y,{key:0,onAnimationDone:B})):C("",!0)])]),e(t)!==null&&e(t)!==100?(m(),p("div",qe,[e(t)!==100?(m(),F(Q,{key:0,class:"absolute -top-8 left-1/2 -translate-x-1/2 -translate-y-full",onClick:d[2]||(d[2]=k=>e(t)<100?t.value+=50:t.value=100)})):C("",!0),i("div",{class:"bg-red-600 h-full duration-200",style:K({width:`${e(t)}%`})},null,4)])):C("",!0),L(ce,null,{default:I(()=>[E(i("div",ze,[i("span",Ke,de(e(s)),1)],512),[[S,e(s)]])]),_:1})])}}};export{Xe as default};
