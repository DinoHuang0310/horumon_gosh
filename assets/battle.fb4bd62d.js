import{_ as q,a as te}from"./BallThrowing.0a4ad44e.js";import{r,w as x,a as P,b as E,e as W,o as m,f as h,h as ae,i as z,u as e,j as T,v as A,k as i,l as L,m as I,p as w,q as O,s as j,t as K,x as ne,y as U,z as oe,A as G,B as se,C as le,D as re,F as ie,E as ce,c as V,T as ue,G as N,H as de,I as me,J as ve}from"./entry.8152d56b.js";import"./_plugin-vue_export-helper.c27b6911.js";const H={__name:"SlideToggle",props:{stay:{type:Number,default:2e3},modelValue:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(b,{emit:f}){const u=b,s=r(null),a=r(u.modelValue?0:2);x(()=>u.modelValue,t=>{t&&(a.value=0)});const v=P(()=>a.value===0?"animate__fadeInRight":a.value===1?"animate__fadeOutRight":"translate-x-full"),n=()=>{a.value===0?setTimeout(()=>{a.value++},u.stay):(a.value++,f("update:modelValue",!1))},_=()=>{s.value.removeEventListener("webkitAnimationEnd",n),s.value.removeEventListener("animationend",n),s.value.removeEventListener("oanimationend",n)};return E(()=>{s.value.addEventListener("webkitAnimationEnd",n),s.value.addEventListener("animationend",n),s.value.addEventListener("oanimationend",n)}),W(()=>{_()}),(t,d)=>(m(),h("div",{ref_key:"elRef",ref:s,class:z(["animate__animated",e(v)])},[ae(t.$slots,"default")],2))}},_e=""+new URL("change-chance.38de7a4b.png",import.meta.url).href,fe={class:"flex justify-center items-center bg-white"},he={class:"w-1/5 mx-4"},pe={key:0,class:"relative"},ge={class:"w-1/5 mx-4"},be={class:"relative"},we={class:"absolute top-0 right-0 flex items-center justify-end w-full h-full"},Ce=i("img",{class:"w-80",src:_e,alt:""},null,-1),ye={__name:"ChangeChance",props:{card:{type:Object,required:!0}},emits:["takeCard"],setup(b,{emit:f}){const u=b,{lockCard:s}=K(),a=r(!0),v=r(null),n=()=>{f("takeCard",{origin:u.card,target:u.card})},_=()=>{window.removeEventListener("beforeunload",n)};return E(()=>{const t=()=>{const d=s(1,{maxChance:j[5],highChance:j[4]})[0];d.cardId===u.card.cardId?t():v.value=d};t(),window.addEventListener("beforeunload",n)}),W(_),(t,d)=>{const p=q,o=H;return m(),h("div",fe,[T(i("div",he,[e(v)?(m(),h("div",pe,[L(p,{card:e(v)},{default:I(()=>[i("button",{class:"relative px-4 py-2 bg-slate-400",onClick:d[0]||(d[0]=g=>t.$emit("takeCard",{origin:b.card,target:e(v)}))},"取得")]),_:1},8,["card"])])):w("",!0)],512),[[A,!e(a)]]),T(i("div",ge,[i("div",be,[L(p,{card:b.card},{default:I(()=>[i("button",{class:"relative px-4 py-2 bg-slate-400",onClick:d[1]||(d[1]=g=>t.$emit("takeCard",{origin:b.card,target:b.card}))},"取得")]),_:1},8,["card"])])],512),[[A,!e(a)]]),T(i("div",we,[L(o,{modelValue:e(a),"onUpdate:modelValue":d[2]||(d[2]=g=>O(a)?a.value=g:null)},{default:I(()=>[Ce]),_:1},8,["modelValue"])],512),[[A,e(a)]])])}}},ke=""+new URL("fortune_wheel.3cd7285e.png",import.meta.url).href,xe=""+new URL("senior_wheel.5bb4acdf.png",import.meta.url).href,$e=""+new URL("senior.cfd57353.png",import.meta.url).href,De={class:"relative pb-[100%]"},Re=["src"],Le={class:"fixed top-0 right-0 flex items-center justify-end w-full h-full"},Ie=i("img",{class:"w-80",src:$e,alt:""},null,-1),Te={__name:"FortuneWheel",emits:["animationDone"],setup(b,{emit:f}){const u=r(Math.random()<ne),s=r(!1),a=r(!1);x(a,p=>{p||(s.value=!0,setTimeout(()=>{n.value=!0},1e3))});const v=P(()=>new URL(Object.assign({"../assets/images/fortune_wheel.png":ke,"../assets/images/senior_wheel.png":xe})[`../assets/images/${s.value?"senior":"fortune"}_wheel.png`],self.location).href),n=r(!u.value),_=r(0);x(n,p=>{if(p)window.requestAnimationFrame(t);else{let o=0,g=9;if(u.value)o=1;else{const k=Math.random();for(const[F,$]of U)if(k<$.appear){console.log(`${k}`,`got ${F}`),o=$.bonus,g=$.degree;break}}f("animationDone",o),oe(()=>{_.value=g})}});const t=()=>{n.value&&(_.value=_.value>=330?0:_.value+30,window.requestAnimationFrame(t))},d=()=>{n.value&&(n.value=!1)};return E(()=>{u.value&&(a.value=!0),window.requestAnimationFrame(t)}),(p,o)=>{const g=H;return m(),h("div",De,[i("img",{class:"block absolute left-0 top-0 w-full",style:G({transform:`rotate(${e(_)}deg)`}),src:e(v),alt:"",onClick:d},null,12,Re),T(i("div",Le,[L(g,{modelValue:e(a),"onUpdate:modelValue":o[0]||(o[0]=k=>O(a)?a.value=k:null)},{default:I(()=>[Ie]),_:1},8,["modelValue"])],512),[[A,e(a)]])])}}},Ae=""+new URL("arrow_l.c01e8aed.png",import.meta.url).href,Ee=""+new URL("arrow_r.c985b9bc.png",import.meta.url).href,Be=["src"],Se={__name:"Keyboard",setup(b){const f=r(!0);return x(()=>f.value,u=>{setTimeout(()=>{f.value=!u},200)}),E(()=>{f.value=!f.value}),(u,s)=>(m(),h("img",{src:e(f)?e(Ae):e(Ee),alt:""},null,8,Be))}},Ve={class:"relative"},Ue={class:"relative flex justify-center items-center h-[60vh]"},Pe={class:"relative"},Fe=["onClick"],Me=i("span",null,"取得",-1),je={key:0,class:"absolute right-0 -top-2 bg-red-500 text-white text-sm rounded whitespace-nowrap px-2 py-1 translate-x-2/3 rotate-[20deg]"},Ne={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},qe={class:"h-[40vh] overflow-hidden"},We={class:"w-1/2 mx-auto"},ze={key:1,class:"absolute left-1/2 bottom-1/4 w-9/12 h-4 -translate-x-1/2 border"},Oe={class:"absolute w-full text-center top-1/2 left-0 -translate-y-1/2 bg-red-600"},Ke={class:"inline-block text-white text-2xl sm:text-6xl italic py-8 animate__animated animate__flipInX"},Xe={__name:"battle",setup(b){const{lockCard:f,removeCard:u}=K(),s=r("");x(s,l=>{l!==""&&setTimeout(()=>{s.value=""},2e3)});const a=r([]),v=r([]),n=r(0);x(n,()=>{d.value&&v.value.length===n.value&&(console.log("全拿了! 結束 || 沒抓到 結束"),$())});const _=r([]),t=r(null),d=r(!1),p=r(0),o=se({addition:0,animationStart:!1,animationDone:!1,setBallColor:P(()=>o.addition===U.get("masterBall").bonus?"purple":o.addition===U.get("highBall").bonus?"yellow":o.addition===U.get("superBall").bonus?"blue":"#dc2626")});x(t,l=>{l===100&&(document.removeEventListener("keyup",k),s.value="Done !",setTimeout(()=>{d.value=!0},1e3))});const g=()=>{a.value=f(2,{maxChance:N[5],highChance:N[4]}),p.value++,s.value=`BATTLE ROUND ${p.value<2?"1":"2"} !`,setTimeout(()=>{t.value=0,document.addEventListener("keyup",k)},2e3)},k=l=>{const{code:c}=l;(c==="ArrowLeft"||c==="ArrowRight")&&(t.value<100?t.value+=10:t.value=100)},F=l=>{o.addition=l,o.animationStart=!0,a.value.forEach(c=>{const D=Math.random(),R=ve[c.cardLevel]+l;console.log(`${c.cardLevel}星目標`,`${R>1?100:R*100}%`,D),D<(R>1?1:R)&&v.value.push({id:c.cardId,chance:Math.random()})})},$=()=>{d.value=!1,o.addition=0,o.animationStart=!1,o.animationDone=!1,n.value=0,S.value=0,v.value.length=0,_.value.length=0,p.value<2&&Math.random()<le?(console.log("連續對戰!"),g()):re("/")},B=r(null),J=({origin:l,target:c})=>{B.value=null,n.value++,_.value.push(l.cardId),u(c.cardId)},X=l=>{if(M(l.cardId)){B.value=l;return}else n.value++,_.value.push(l.cardId),u(l.cardId)},S=r(0),M=l=>{const c=v.value.find(D=>D.id===l);return c?c.chance<me:!1},Y=P(()=>l=>o.animationDone?l?"capture-success":"capture-failed":"");return E(g),(l,c)=>{const D=q,R=te,Q=ye,Z=Te,ee=Se;return m(),h("div",Ve,[i("div",Ue,[(m(!0),h(ie,null,ce(e(a),C=>(m(),h("div",{key:C.cardId,class:z(["w-1/5 mx-4 animate__animated animate__flipInY",[e(_).some(y=>y===C.cardId)&&"invisible"]])},[i("div",Pe,[L(D,{class:"animate__animated",animation:e(Y)(e(v).some(y=>y.id===C.cardId)),card:C,onAnimationDone:c[0]||(c[0]=y=>S.value++)},{default:I(()=>[e(v).some(y=>y.id===C.cardId)&&e(S)===2?(m(),h("button",{key:0,class:"relative px-4 py-2 bg-slate-400",onClick:y=>X(C)},[Me,M(C.cardId)?(m(),h("span",je," 交換機會 ")):w("",!0)],8,Fe)):w("",!0)]),_:2},1032,["animation","card"]),i("div",Ne,[e(o).animationStart?(m(),V(R,{key:0,color:e(o).setBallColor,onAnimationDone:c[1]||(c[1]=y=>e(o).animationDone=!0)},null,8,["color"])):w("",!0)])])],2))),128)),e(S)===2?(m(),h("button",{key:0,class:"absolute bottom-2 left-1/2 -translate-x-1/2 px-4 py-2 bg-slate-400",onClick:$},"不取得")):w("",!0)]),e(B)?(m(),V(Q,{key:0,class:"absolute w-full h-full top-0 left-0 z-10",card:e(B),onTakeCard:J},null,8,["card"])):w("",!0),i("div",qe,[i("div",We,[e(d)?(m(),V(Z,{key:0,onAnimationDone:F})):w("",!0)])]),e(t)!==null&&e(t)!==100?(m(),h("div",ze,[e(t)!==100?(m(),V(ee,{key:0,class:"absolute -top-8 left-1/2 -translate-x-1/2 -translate-y-full",onClick:c[2]||(c[2]=C=>e(t)<100?t.value+=50:t.value=100)})):w("",!0),i("div",{class:"bg-red-600 h-full duration-200",style:G({width:`${e(t)}%`})},null,4)])):w("",!0),L(ue,null,{default:I(()=>[T(i("div",Oe,[i("span",Ke,de(e(s)),1)],512),[[A,e(s)]])]),_:1})])}}};export{Xe as default};
